{% extends 'cae_tools/documentation/testing/main.html' %}
{% load static %}


{% block title_page_name %}AbstractTestHelper Utility Class |  {{ block.super }}{% endblock title_page_name %}


{% block content %}
  {{ block.super }}

  <h2>AbstractTestHelper Utility Class</h2>
  <p>
    The Workspace AbstractTestHelper utility class is the most basic/minimal custom test utility class. All other test
    classes have this logic, plus more.
  </p>
  <p>
    This class is an abstract class, so it cannot be inherited directly.
  </p>
  <p>
    The BaseTestCase utility class has the following helper logic:
  </p>

  <article class="color">
    <h3>Debug Print</h3>
    <p>
      The <span class="highlight code">self.debug_print()</span> function displays out a handful of helpful Django debug
      information, such as current context data, current form data, and any messages stored within the current response
      context. See below functions for explanations of exactly what this debug function calls.
    </p>
    <p>
      This can be very useful when trying to debug a test you're writing, when it doesn't seem to be behaving as you'd
      expect.
    </p>
    <p>
      Note: This is automatically called on error, when running tests via <a href="">PyTest</a> (recommended way to run
      tests).
    </p>

    <h4>Debut Print Content</h4>
    <p>
      The <span class="highlight code">self.debug_print_content()</span> function displays the direct page content to
      console.
    </p>
    <p>
      This "page content" is the direct html that is rendered to browser, with "extra whitespace" trimmed, some special
      characters/codes escaped to prevent errors, and other characters/codes formatted to make console output more
      human-legible. For the most part though, it's a direct one-to-one match of the literal HTML sent to the browser
      for page rendering.
    </p>

    <h4>Debut Print Context</h4>
    <p>
      The <span class="highlight code">self.debug_print_context()</span> function displays all view and middleware
      variables passed to the template.
    </p>

    <h4>Debut Print Forms</h4>
    <p>
      The <span class="highlight code">self.debug_print_forms()</span> function displays some template form data,
      particularly anything about form errors.
    </p>

    <h4>Debut Print Messages</h4>
    <p>
      The <span class="highlight code">self.debug_print_messages()</span> function displays request-messages, if any
      are present on page.
    </p>

    <h4>Debut Print Permissions</h4>
    <p>
      The <span class="highlight code">self.debug_print_permissions()</span> function displays all auth-groups the
      current user is part of, as well as all individual permissions assigned to current user.
    </p>
  </article>

  <article class="color">
    <h3>Create Default Users and Groups</h3>
    <p>
      The <span class="highlight code">self.create_default_users_and_groups()</span> function will generate (login) User
      models, as specified in <span class="highlight primary">cae_home/management/commands/seeders/user.py</span> logic.
    </p>
    <p>
      This is good to call at the start of any tests that needs (login) User model data, as many of our views depend
      on specific group/permission combinations. And the seeder generates various test user models which meet these
      expected combinations.
    </p>
  </article>

  <article class="color">
    <h3>Create User</h3>
    <p>
      The <span class="highlight code">self.create_user()</span> function will create a (login) User model with the
      provided username/password/permission/group values.
    </p>
    <p>
      In other words, it's an easy helper function to create new (login) User models quickly.
    </p>
  </article>

  <article class="color">
    <h3>Get User</h3>
    <p>
      The <span class="highlight code">self.get_user()</span> function will attempt to get a (login) User model with
      the provided username value.
    </p>
    <p>
      On failure, it will print all available (login) User models, and raise an ObjectDoesNotExist error.
    </p>
  </article>

  <article class="color">
    <h3>Add Permission</h3>
    <p>
      The <span class="highlight code">self.add_permission()</span> function adds a Django Auth Permission to the given
      user.
    </p>
    <p>
      On failure, it will print all available Permission model values, and raise an ObjectDoesNotExist error.
    </p>
  </article>

  <article class="color">
    <h3>Add Group</h3>
    <p>
      The <span class="highlight code">self.add_group()</span> function adds a Django Auth Group to the given user.
    </p>
    <p>
      On failure, it will print all available Group model values, and raise an ObjectDoesNotExist error.
    </p>
  </article>
{% endblock content %}
